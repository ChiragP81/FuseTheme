<div id="forms" class="page-layout simple fullwidth" fxLayout="column">

    <!-- HEADER -->
    <div class="header accent p-24 h-100" fxLayout="row" fxLayoutAlign="start center">
        <div fxLayout="column" fxLayoutAlign="center start">
            <div fxLayout="row" fxLayoutAlign="start center">
                <mat-icon class="secondary-text s-18">home</mat-icon>
                <span style="cursor: pointer;" class="secondary-text ml-5" [routerLink]="['/dashboard']">Home</span>
                <mat-icon class="secondary-text s-16">chevron_right</mat-icon>
                <span style="cursor: pointer;" class="secondary-text" [routerLink]="['/apps/news/newslist']">Manage
                    News</span>
                <mat-icon class="secondary-text s-16">chevron_right</mat-icon>
                <span class="secondary-text">{{pageTitle}}</span>
            </div>
            <!-- <div class="h1 mt-16" [innerHTML]="pageTitle"></div> -->
        </div>
    </div>
    <!-- / HEADER -->

    <!-- CONTENT -->
    <div class="content px-12 py-24">
        <div fxLayout="column" fxLayoutAlign="start" fxLayout.gt-md="row">
            <form (ngSubmit)="submitNewsForm()" [formGroup]="newsForm" fxLayout="column" fxLayoutAlign="start"
                fxFlex="1 1 auto">

                <div fxLayout="row wrap" fxLayoutAlign="start center" fxFlex="1 1 auto">

                    <mat-form-field class="px-12" appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>News Title</mat-label>
                        <input matInput formControlName="news_title" required />
                        <mat-error *ngIf="newsForm.get('news_title').hasError('required')">
                            News Title is required
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="px-12" appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>News Type</mat-label>
                        <mat-select formControlName="news_type" required>
                            <mat-option *ngFor="let type of news_type" [value]="type.NewsTypeID">
                                {{type.NewsType}}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="newsForm.get('news_type').hasError('required')">
                            News Type is required
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="px-12" appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>News URL </mat-label>
                        <input matInput formControlName="news_url" />
                        <mat-error *ngIf="newsForm.get('news_url').hasError('pattern')">
                            {{urlPatternError}}
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="px-12" appearance="outline" fxFlex="100">
                            <mat-label>News Description</mat-label>
                            <textarea matInput formControlName="news_description" required></textarea>
                            <mat-error *ngIf="newsForm.get('news_description').hasError('required')">
                                News Description is required
                            </mat-error>
                        </mat-form-field>

                    <mat-form-field class="px-12" appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>News Media type</mat-label>
                        <mat-select formControlName="media_type" (selectionChange)="changeMediaValue($event.value)"
                            required>
                            <mat-option *ngFor="let mediaType of news_media_type" [value]="mediaType.value">
                                {{mediaType.displayValue}}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="newsForm.get('media_type').hasError('required')">
                            News Media Type is required
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="px-12 file-form-field" *ngIf="newsForm.get('media_type').value == 0 " appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>Media Image</mat-label>
                        <input matInput hidden formControlName="news_media" required>
                        <input class="ng-hide" type="file" (change)="uploadMedia('0',$event.target.files)"
                            [accept]="imageAcceptTypes"
                            [class.imageInput]="newsForm.get('news_media').hasError('required')" required />
                        <mat-error *ngIf="newsForm.get('news_media').hasError('required')">
                            Please select Media Image !
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="px-12 file-form-field" *ngIf="newsForm.get('media_type').value == 1 " appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>Media Video</mat-label>
                        <input matInput hidden formControlName="news_media" required>
                        <input class="ng-hide" type="file" (change)="uploadMedia('1',$event.target.files)"
                            [accept]="videoAcceptTypes"
                            [class.imageInput]="newsForm.get('news_media').hasError('required')" required />
                        <mat-error *ngIf="newsForm.get('news_media').hasError('required')">
                            Please select Media Image !
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="px-12 file-form-field" *ngIf="newsForm.get('media_type').value == 1 " appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>Media Video Thumbnail</mat-label>
                        <input matInput hidden formControlName="video_thumbnail">
                        <input class="ng-hide imgTextEllipsis" type="file"
                            (change)="uploadVideoThumbnail($event.target.files)" [accept]="imageAcceptTypes"
                            [class.imageInputThumb]="newsForm.get('video_thumbnail').value === ''" required />
                        <mat-error
                            *ngIf="newsForm.get('media_type').value == 1 && newsForm.get('video_thumbnail').value === ''">
                            Please select Video Thumbnail !
                        </mat-error>
                    </mat-form-field>


                    <mat-form-field class="px-12" appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>Institute </mat-label>
                        <mat-select formControlName="institute_uid" required>
                            <mat-option *ngFor="let institute of instituteList" [value]="institute.institute_uid">
                                {{institute.institute_name}}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="newsForm.get('institute_uid').hasError('required')">
                            Please Select Institute
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="px-12" appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33"
                        *ngIf="isSuperAdmin">
                        <mat-label>Responsible User </mat-label>
                        <mat-select formControlName="user_uid" required>
                            <mat-option *ngFor="let user of usersList" [value]="user.user_uid">
                                {{ user.first_name }}&nbsp;{{ user.last_name }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="newsForm.get('user_uid').hasError('required')">
                            Please Select User
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field class="px-12 hidden" appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>Responsible User </mat-label>
                        <input matInput formControlName="user_uid" />
                    </mat-form-field>

                    <mat-form-field class="px-12" appearance="outline" fxFlex="100" fxFlex.gt-xs="50" fxFlex.gt-sm="33.33" fxFlex.gt-md="33.33">
                        <mat-label>Status </mat-label>
                        <mat-select formControlName="status" required>
                            <mat-option *ngFor="let status of statusData" [value]="status.value">
                                {{ status.displayValue }}
                            </mat-option>
                        </mat-select>
                        <mat-error *ngIf="newsForm.get('status').hasError('required')">
                            Please Select Status
                        </mat-error>
                    </mat-form-field>
                </div>

                <div class="px-12" fxFlex="100" fxFlex.gt-xs="50" *ngIf="newsData && newsMediaSrc">
                    <mat-label>Media</mat-label>
                    <div class="mt-4 mb-20" *ngIf="mediaInnerHtml" [innerHTML]="mediaInnerHtml">
                    </div>
                </div>

                <div class="px-12" fxFlex="100" fxFlex.gt-xs="50" *ngIf="newsData && thumbnailSrc">
                    <mat-label>Media Thumbnail</mat-label>
                    <div class="mt-4 mb-20" *ngIf="thumbnailHtml" [innerHTML]="thumbnailHtml">
                    </div>
                </div>

                <div fxLayout="row wrap" fxLayoutAlign="start center" fxFlex="1 0 auto">
                    <div class="px-12" fxFlex="100">
                        <button type="submit" mat-raised-button color="primary" *ngIf="!loading"
                            [disabled]="!newsForm.valid || ( newsForm.get('media_type').value == 1 && newsForm.get('video_thumbnail').value === '')">Submit</button>
                        &nbsp;&nbsp;
                        <button mat-raised-button class="loading-btn" color="primary"
                            *ngIf="loading">Submitting</button>&nbsp;&nbsp;
                        <button mat-raised-button (click)="navigateToListing()" [disabled]="loading">Cancel</button>
                    </div>
                </div>

            </form>
        </div>

    </div>
    <!-- / CONTENT -->

</div>